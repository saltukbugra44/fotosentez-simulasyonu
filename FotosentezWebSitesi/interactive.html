<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fotosentez Simülasyon Laboratuvarı 🧪</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .lab-container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            height: 100vh;
            gap: 20px;
            padding: 20px;
        }

        .control-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .simulation-area {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            border: 2px solid #4CAF50;
        }

        .stats-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        h2 {
            margin-bottom: 20px;
            color: #4CAF50;
            text-align: center;
        }

        .slider-container {
            margin-bottom: 20px;
        }

        .slider-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.3);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
        }

        .value-display {
            text-align: right;
            font-weight: bold;
            color: #4CAF50;
        }

        .control-button {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76,175,80,0.4);
        }

        .control-button:active {
            transform: scale(0.95);
        }

        .danger-button {
            background: linear-gradient(45deg, #f44336, #da190b);
        }

        .chloroplast {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 200px;
            background: radial-gradient(ellipse, #8BC34A, #4CAF50);
            border-radius: 50%;
            border: 3px solid #2E7D32;
        }

        .thylakoid {
            position: absolute;
            background: linear-gradient(90deg, #66BB6A, #4CAF50);
            border-radius: 10px;
            animation: thylakoidGlow 2s ease-in-out infinite;
        }

        .thylakoid-1 {
            top: 30%;
            left: 20%;
            width: 60px;
            height: 15px;
        }

        .thylakoid-2 {
            top: 45%;
            left: 25%;
            width: 50px;
            height: 15px;
        }

        .thylakoid-3 {
            top: 60%;
            left: 30%;
            width: 40px;
            height: 15px;
        }

        @keyframes thylakoidGlow {
            0%, 100% { box-shadow: 0 0 5px #4CAF50; }
            50% { box-shadow: 0 0 20px #8BC34A; }
        }

        .molecule {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .molecule:hover {
            transform: scale(1.3);
        }

        .co2 {
            background: #f44336;
            color: white;
        }

        .h2o {
            background: #2196F3;
            color: white;
        }

        .o2 {
            background: #FF9800;
            color: white;
        }

        .glucose {
            background: #9C27B0;
            color: white;
        }

        .atp {
            background: #FFEB3B;
            color: black;
        }

        .photon {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #FFEB3B;
            border-radius: 50%;
            box-shadow: 0 0 10px #FFEB3B;
        }

        .electron {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #00BCD4;
            border-radius: 50%;
            box-shadow: 0 0 8px #00BCD4;
        }

        .stat-item {
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(76,175,80,0.2);
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }

        .experiment-area {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            height: 100px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            border: 2px dashed #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
        }

        .draggable {
            cursor: move;
            user-select: none;
        }

        .drop-zone {
            border: 2px dashed #4CAF50;
            background: rgba(76,175,80,0.1);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .equation-builder {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 60px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
        }

        .equation-slot {
            width: 50px;
            height: 50px;
            border: 2px dashed #4CAF50;
            border-radius: 8px;
            margin: 0 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .equation-slot.filled {
            border-color: #8BC34A;
            background: rgba(76,175,80,0.3);
        }

        .success-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(76,175,80,0.9);
            padding: 30px;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
            z-index: 1000;
            animation: successPop 0.5s ease-out;
            display: none;
        }

        @keyframes successPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .mobile-note {
            display: none;
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            background: rgba(255,193,7,0.9);
            color: black;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            z-index: 100;
        }

        @media (max-width: 768px) {
            .lab-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr;
                height: auto;
                min-height: 100vh;
            }
            
            .mobile-note {
                display: block;
            }

            .simulation-area {
                min-height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="mobile-note">
        📱 En iyi deneyim için bilgisayar kullanın! Mobilde temel özellikler çalışır.
    </div>

    <div class="success-message" id="successMessage">
        🎉 Tebrikler! Fotosentez denklemini doğru kurdunuz!
    </div>

    <div class="lab-container">
        <!-- Sol Panel: Kontroller -->
        <div class="control-panel">
            <h2>🔬 Deney Kontrolleri</h2>
            
            <div class="slider-container">
                <label class="slider-label">🌞 Işık Şiddeti</label>
                <input type="range" min="0" max="100" value="50" class="slider" id="lightIntensity">
                <div class="value-display" id="lightValue">50%</div>
            </div>

            <div class="slider-container">
                <label class="slider-label">💧 Su Miktarı</label>
                <input type="range" min="0" max="100" value="50" class="slider" id="waterAmount">
                <div class="value-display" id="waterValue">50%</div>
            </div>

            <div class="slider-container">
                <label class="slider-label">🌫️ CO₂ Konsantrasyonu</label>
                <input type="range" min="0" max="100" value="50" class="slider" id="co2Level">
                <div class="value-display" id="co2Value">50%</div>
            </div>

            <div class="slider-container">
                <label class="slider-label">🌡️ Sıcaklık</label>
                <input type="range" min="0" max="100" value="50" class="slider" id="temperature">
                <div class="value-display" id="tempValue">50°C</div>
            </div>

            <button class="control-button" onclick="startExperiment()">🧪 Deneyi Başlat</button>
            <button class="control-button" onclick="addMolecules()">⚛️ Molekül Ekle</button>
            <button class="control-button" onclick="resetExperiment()" class="danger-button">🔄 Sıfırla</button>
            <button class="control-button" onclick="autoMode()">🤖 Otomatik Mod</button>
        </div>

        <!-- Orta: Simulasyon Alanı -->
        <div class="simulation-area" id="simulationArea">
            <div class="equation-builder" id="equationBuilder">
                <div class="equation-slot" data-type="co2"></div>
                <span> + </span>
                <div class="equation-slot" data-type="h2o"></div>
                <span> + Işık → </span>
                <div class="equation-slot" data-type="glucose"></div>
                <span> + </span>
                <div class="equation-slot" data-type="o2"></div>
            </div>

            <div class="chloroplast" id="chloroplast">
                <div class="thylakoid thylakoid-1"></div>
                <div class="thylakoid thylakoid-2"></div>
                <div class="thylakoid thylakoid-3"></div>
            </div>

            <div class="experiment-area" id="experimentArea">
                📋 Molekülleri buraya sürükleyip fotosentez denklemini kurun!
            </div>
        </div>

        <!-- Sağ Panel: İstatistikler -->
        <div class="stats-panel">
            <h2>📊 Canlı Veriler</h2>
            
            <div class="stat-item">
                <div class="stat-label">O₂ Üretimi</div>
                <div class="stat-value" id="o2Production">0 mol/s</div>
            </div>

            <div class="stat-item">
                <div class="stat-label">ATP Sentezi</div>
                <div class="stat-value" id="atpSynthesis">0 ATP/s</div>
            </div>

            <div class="stat-item">
                <div class="stat-label">Glukoz Üretimi</div>
                <div class="stat-value" id="glucoseProduction">0 g/s</div>
            </div>

            <div class="stat-item">
                <div class="stat-label">CO₂ Tüketimi</div>
                <div class="stat-value" id="co2Consumption">0 mol/s</div>
            </div>

            <div class="stat-item">
                <div class="stat-label">Fotosentez Verimliliği</div>
                <div class="stat-value" id="efficiency">0%</div>
            </div>

            <div class="stat-item">
                <div class="stat-label">Aktif Kloroplast Sayısı</div>
                <div class="stat-value" id="activeChloroplasts">0</div>
            </div>

            <h2 style="margin-top: 30px;">🎯 Deneyim Görevleri</h2>
            <div style="font-size: 14px;">
                <p>✅ Işık şiddetini ayarlayın</p>
                <p>✅ Molekülleri doğru yerlere sürükleyin</p>
                <p>✅ Fotosentez denklemini tamamlayın</p>
                <p>✅ Optimum koşulları bulun</p>
                <p>✅ %80+ verimlilik elde edin</p>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let isExperimentRunning = false;
        let molecules = [];
        let photons = [];
        let electrons = [];
        let stats = {
            o2: 0,
            atp: 0,
            glucose: 0,
            co2Consumed: 0,
            efficiency: 0
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupSliders();
            addInitialMolecules();
            startStatsUpdate();
        });

        function setupSliders() {
            const sliders = document.querySelectorAll('.slider');
            sliders.forEach(slider => {
                slider.addEventListener('input', function() {
                    updateSliderValue(this);
                    updateExperiment();
                });
            });
        }

        function updateSliderValue(slider) {
            const value = slider.value;
            const valueDisplay = document.getElementById(slider.id.replace(/[A-Z]/g, '') + 'Value') || 
                                document.getElementById(slider.id + 'Value');
            
            if (slider.id === 'temperature') {
                valueDisplay.textContent = value + '°C';
            } else {
                valueDisplay.textContent = value + '%';
            }
        }

        function addInitialMolecules() {
            const types = ['co2', 'h2o', 'o2', 'glucose'];
            const colors = ['#f44336', '#2196F3', '#FF9800', '#9C27B0'];
            const labels = ['CO₂', 'H₂O', 'O₂', 'C₆H₁₂O₆'];

            types.forEach((type, index) => {
                for (let i = 0; i < 3; i++) {
                    createMolecule(type, colors[index], labels[index]);
                }
            });
        }

        function createMolecule(type, color, label) {
            const molecule = document.createElement('div');
            molecule.className = 'molecule draggable ' + type;
            molecule.style.background = color;
            molecule.textContent = label;
            molecule.dataset.type = type;

            // Random position
            molecule.style.left = Math.random() * 80 + 10 + '%';
            molecule.style.top = Math.random() * 60 + 20 + '%';

            // Make draggable
            makeDraggable(molecule);
            
            document.getElementById('simulationArea').appendChild(molecule);
            molecules.push(molecule);
        }

        function makeDraggable(element) {
            let isDragging = false;
            let startX, startY, initialLeft, initialTop;

            element.addEventListener('mousedown', startDrag);
            element.addEventListener('touchstart', startDrag, { passive: false });

            function startDrag(e) {
                isDragging = true;
                const clientX = e.clientX || e.touches[0].clientX;
                const clientY = e.clientY || e.touches[0].clientY;
                
                startX = clientX;
                startY = clientY;
                initialLeft = element.offsetLeft;
                initialTop = element.offsetTop;

                element.style.zIndex = '1000';
                e.preventDefault();

                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
                document.addEventListener('touchmove', drag, { passive: false });
                document.addEventListener('touchend', stopDrag);
            }

            function drag(e) {
                if (!isDragging) return;
                
                const clientX = e.clientX || e.touches[0].clientX;
                const clientY = e.clientY || e.touches[0].clientY;
                
                const deltaX = clientX - startX;
                const deltaY = clientY - startY;

                element.style.left = (initialLeft + deltaX) + 'px';
                element.style.top = (initialTop + deltaY) + 'px';
                
                e.preventDefault();
            }

            function stopDrag(e) {
                if (!isDragging) return;
                isDragging = false;
                element.style.zIndex = 'auto';

                // Check if dropped on equation slot
                checkEquationDrop(element, e);

                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
                document.removeEventListener('touchmove', drag);
                document.removeEventListener('touchend', stopDrag);
            }
        }

        function checkEquationDrop(molecule, e) {
            const slots = document.querySelectorAll('.equation-slot');
            const moleculeRect = molecule.getBoundingClientRect();
            const moleculeCenterX = moleculeRect.left + moleculeRect.width / 2;
            const moleculeCenterY = moleculeRect.top + moleculeRect.height / 2;

            slots.forEach(slot => {
                const slotRect = slot.getBoundingClientRect();
                
                if (moleculeCenterX >= slotRect.left && 
                    moleculeCenterX <= slotRect.right &&
                    moleculeCenterY >= slotRect.top && 
                    moleculeCenterY <= slotRect.bottom) {
                    
                    if (slot.dataset.type === molecule.dataset.type) {
                        slot.classList.add('filled');
                        slot.innerHTML = molecule.innerHTML;
                        molecule.remove();
                        
                        // Check if equation is complete
                        checkEquationComplete();
                        createParticleEffect(slotRect.left + slotRect.width/2, slotRect.top + slotRect.height/2, '#4CAF50');
                    }
                }
            });
        }

        function checkEquationComplete() {
            const filledSlots = document.querySelectorAll('.equation-slot.filled');
            if (filledSlots.length === 4) {
                showSuccess();
                startPhotosynthesisAnimation();
            }
        }

        function showSuccess() {
            const successMsg = document.getElementById('successMessage');
            successMsg.style.display = 'block';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
        }

        function startExperiment() {
            isExperimentRunning = !isExperimentRunning;
            const button = event.target;
            
            if (isExperimentRunning) {
                button.textContent = '⏹️ Deneyi Durdur';
                button.style.background = 'linear-gradient(45deg, #f44336, #da190b)';
                startPhotonGeneration();
                startElectronFlow();
            } else {
                button.textContent = '🧪 Deneyi Başlat';
                button.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                stopAllAnimations();
            }
        }

        function startPhotonGeneration() {
            if (!isExperimentRunning) return;

            const lightIntensity = document.getElementById('lightIntensity').value;
            const interval = Math.max(50, 500 - (lightIntensity * 4));

            createPhoton();
            setTimeout(startPhotonGeneration, interval);
        }

        function createPhoton() {
            const photon = document.createElement('div');
            photon.className = 'photon';
            photon.style.left = Math.random() * 100 + '%';
            photon.style.top = '10px';

            document.getElementById('simulationArea').appendChild(photon);

            // Animate photon movement
            let position = 10;
            const animation = setInterval(() => {
                position += 5;
                photon.style.top = position + 'px';

                // Check collision with chloroplast
                if (position > 200 && position < 400) {
                    createElectron();
                    createParticleEffect(photon.offsetLeft, photon.offsetTop, '#FFEB3B');
                    clearInterval(animation);
                    photon.remove();
                    return;
                }

                if (position > window.innerHeight) {
                    clearInterval(animation);
                    photon.remove();
                }
            }, 50);
        }

        function createElectron() {
            const electron = document.createElement('div');
            electron.className = 'electron';
            
            const chloroplast = document.getElementById('chloroplast');
            const rect = chloroplast.getBoundingClientRect();
            
            electron.style.left = (rect.left + rect.width/2) + 'px';
            electron.style.top = (rect.top + rect.height/2) + 'px';

            document.getElementById('simulationArea').appendChild(electron);

            // Animate electron in circular path
            let angle = 0;
            const radius = 50;
            const centerX = rect.left + rect.width/2;
            const centerY = rect.top + rect.height/2;

            const animation = setInterval(() => {
                angle += 0.2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                electron.style.left = x + 'px';
                electron.style.top = y + 'px';

                if (angle > Math.PI * 4) { // 2 full circles
                    clearInterval(animation);
                    electron.remove();
                    updateStats();
                }
            }, 50);
        }

        function updateStats() {
            const lightIntensity = parseInt(document.getElementById('lightIntensity').value);
            const waterAmount = parseInt(document.getElementById('waterAmount').value);
            const co2Level = parseInt(document.getElementById('co2Level').value);
            const temperature = parseInt(document.getElementById('temperature').value);

            // Calculate efficiency based on optimal conditions
            const optimalLight = Math.abs(lightIntensity - 70) / 70;
            const optimalWater = Math.abs(waterAmount - 60) / 60;
            const optimalCO2 = Math.abs(co2Level - 80) / 80;
            const optimalTemp = Math.abs(temperature - 25) / 25;

            const efficiency = Math.max(0, 100 - (optimalLight + optimalWater + optimalCO2 + optimalTemp) * 25);

            stats.efficiency = efficiency;
            stats.o2 = (efficiency / 100) * lightIntensity * 0.1;
            stats.atp = (efficiency / 100) * lightIntensity * 0.2;
            stats.glucose = (efficiency / 100) * co2Level * 0.05;
            stats.co2Consumed = (efficiency / 100) * co2Level * 0.08;

            // Update display
            document.getElementById('o2Production').textContent = stats.o2.toFixed(1) + ' mol/s';
            document.getElementById('atpSynthesis').textContent = Math.floor(stats.atp) + ' ATP/s';
            document.getElementById('glucoseProduction').textContent = stats.glucose.toFixed(2) + ' g/s';
            document.getElementById('co2Consumption').textContent = stats.co2Consumed.toFixed(1) + ' mol/s';
            document.getElementById('efficiency').textContent = Math.floor(efficiency) + '%';
            document.getElementById('activeChloroplasts').textContent = Math.floor(efficiency / 10);
        }

        function createParticleEffect(x, y, color) {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.style.position = 'fixed';
                    particle.style.left = x + 'px';
                    particle.style.top = y + 'px';
                    particle.style.width = '4px';
                    particle.style.height = '4px';
                    particle.style.background = color;
                    particle.style.borderRadius = '50%';
                    particle.style.pointerEvents = 'none';
                    particle.style.zIndex = '9999';

                    document.body.appendChild(particle);

                    const angle = (i / 5) * Math.PI * 2;
                    const velocity = 100;
                    const vx = Math.cos(angle) * velocity;
                    const vy = Math.sin(angle) * velocity;

                    let frame = 0;
                    const animate = () => {
                        frame++;
                        const progress = frame / 30;
                        
                        if (progress >= 1) {
                            particle.remove();
                            return;
                        }
                        
                        const currentX = x + vx * progress;
                        const currentY = y + vy * progress + (progress * progress * 100);
                        
                        particle.style.left = currentX + 'px';
                        particle.style.top = currentY + 'px';
                        particle.style.opacity = 1 - progress;
                        
                        requestAnimationFrame(animate);
                    };
                    
                    requestAnimationFrame(animate);
                }, i * 50);
            }
        }

        function addMolecules() {
            addInitialMolecules();
        }

        function resetExperiment() {
            // Clear all molecules
            molecules.forEach(mol => mol.remove());
            molecules = [];
            
            // Clear equation slots
            document.querySelectorAll('.equation-slot').forEach(slot => {
                slot.classList.remove('filled');
                slot.innerHTML = '';
            });
            
            // Reset stats
            Object.keys(stats).forEach(key => stats[key] = 0);
            updateStats();
            
            // Stop experiment
            isExperimentRunning = false;
            const button = document.querySelector('.control-button');
            button.textContent = '🧪 Deneyi Başlat';
            
            // Add new molecules
            addInitialMolecules();
        }

        function autoMode() {
            // Set optimal conditions
            document.getElementById('lightIntensity').value = 70;
            document.getElementById('waterAmount').value = 60;
            document.getElementById('co2Level').value = 80;
            document.getElementById('temperature').value = 25;
            
            // Update displays
            document.querySelectorAll('.slider').forEach(updateSliderValue);
            
            // Start experiment
            if (!isExperimentRunning) {
                startExperiment();
            }
            
            // Auto-complete equation after 2 seconds
            setTimeout(() => {
                const slots = document.querySelectorAll('.equation-slot');
                const types = ['co2', 'h2o', 'glucose', 'o2'];
                const labels = ['CO₂', 'H₂O', 'C₆H₁₂O₆', 'O₂'];
                
                slots.forEach((slot, index) => {
                    if (!slot.classList.contains('filled')) {
                        slot.classList.add('filled');
                        slot.innerHTML = labels[index];
                    }
                });
                
                checkEquationComplete();
            }, 2000);
        }

        function startStatsUpdate() {
            setInterval(() => {
                if (isExperimentRunning) {
                    updateStats();
                }
            }, 1000);
        }

        function updateExperiment() {
            if (isExperimentRunning) {
                updateStats();
            }
        }

        function startPhotosynthesisAnimation() {
            const chloroplast = document.getElementById('chloroplast');
            chloroplast.style.animation = 'thylakoidGlow 0.5s ease-in-out infinite';
            
            setTimeout(() => {
                chloroplast.style.animation = '';
            }, 3000);
        }

        function stopAllAnimations() {
            document.querySelectorAll('.photon, .electron').forEach(el => el.remove());
        }

        // Touch support for mobile
        document.addEventListener('touchstart', function(e) {
            // Prevent default touch behavior on draggable elements
        }, { passive: false });
    </script>
</body>
</html>